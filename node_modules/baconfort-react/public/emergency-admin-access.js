// ACCESO ADMINISTRATIVO DE EMERGENCIA - TEMPORAL
// Este archivo activa el modo de emergencia sin cambiar el código principal

console.log('🚨 ACTIVANDO MODO EMERGENCIA ADMINISTRATIVO');

// Función para simular respuesta exitosa del backend
window.simulateAdminLogin = function() {
  const emergencyAdmin = {
    id: 'emergency-admin-2024',
    email: 'baconfort.centro@gmail.com',
    name: 'Administrador de Emergencia',
    role: 'admin',
    phone: '+54 11 1234-5678',
    emailVerified: true,
    createdAt: new Date().toISOString(),
    isEmergencyMode: true
  };
  
  // Guardar en localStorage como si fuera una sesión normal
  localStorage.setItem('baconfort-user', JSON.stringify(emergencyAdmin));
  localStorage.setItem('baconfort-token', 'emergency-token-' + Date.now());
  
  console.log('✅ EMERGENCIA: Sesión administrativa creada');
  
  // Recargar la página para que tome efecto
  setTimeout(() => {
    window.location.reload();
  }, 1000);
};

// Auto-ejecutar si se detectan las credenciales correctas en la URL
if (window.location.pathname.includes('/admin') || window.location.pathname.includes('access-required')) {
  console.log('🔍 EMERGENCIA: Página administrativa detectada');
  
  // Verificar si ya hay una sesión de emergencia válida
  const existingUser = localStorage.getItem('baconfort-user');
  if (existingUser) {
    try {
      const user = JSON.parse(existingUser);
      if (user.role === 'admin' && user.isEmergencyMode) {
        console.log('✅ EMERGENCIA: Sesión administrativa ya activa');
        return;
      }
    } catch (e) {
      console.log('⚠️ EMERGENCIA: Sesión corrupta, limpiando...');
      localStorage.removeItem('baconfort-user');
      localStorage.removeItem('baconfort-token');
    }
  }
  
  // Mostrar botón de emergencia si no hay sesión
  setTimeout(() => {
    const button = document.createElement('button');
    button.innerHTML = '🚨 ACCESO DE EMERGENCIA';
    button.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 10000;
      background: #ff4444;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    `;
    button.onclick = window.simulateAdminLogin;
    document.body.appendChild(button);
    
    console.log('🚨 EMERGENCIA: Botón de acceso administrativo agregado');
  }, 2000);
}
